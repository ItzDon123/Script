getgenv().AutoFarmDioBoss = true

local function cleanEffects()
    while getgenv().AutoFarmDioBoss do
        wait(0.15)
        pcall(function()
            for , v in pairs(workspace.Effects:GetChildren()) do
                if v.Name == "Hold up, aint you Dio?" or v.Name == "FIRE" or v.Name == 'blood' then
                    v:Destroy()
                end
            end
        end)
    end
end

local function findDioTarget()
    while getgenv().AutoFarmDioBoss do
        pcall(function()
            getgenv().Target = nil
            for , x in ipairs(workspace.Living:GetChildren()) do
                if string.find(x.Name, "Dio") then
                    getgenv().Target = x
                    break
                end
            end
        end)
        task.wait(0.5)
    end
end

local function moveToDio()
    while getgenv().AutoFarmDioBoss do
        pcall(function()
            if getgenv().Target and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character.Humanoid.Health > 0 then
                local target = getgenv().Target
                local humanoidRootPart = game.Players.LocalPlayer.Character.HumanoidRootPart
                local targetPosition = target.HumanoidRootPart.Position
                humanoidRootPart.CFrame = CFrame.new(targetPosition - Vector3.new(0, 0, 5), targetPosition)
            end
        end)
        task.wait(0.1)
    end
end

local DELAY_BEFORE_ATTACKING = 0.125

local function attackAndSpawn()
    while getgenv().AutoFarmDioBoss do
        if game.Players.LocalPlayer.Cooldowns:FindFirstChild("Rush Attack") then
            repeat
                task.wait(0.025)
            until not game.Players.LocalPlayer.Cooldowns:FindFirstChild("Rush Attack")
        end

        task.spawn(function()
            task.wait(DELAY_BEFORE_ATTACKING)
            pcall(function()
                local args = { [1] = "MouseButton1" }
                game:GetService("ReplicatedStorage"):WaitForChild("ReplicatedModules"):WaitForChild("KnitPackage"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("MoveInputService"):WaitForChild("RF"):WaitForChild("FireInput"):InvokeServer(unpack(args))
            end)
        end)

        local spawnArgs = { [1] = "Spawn Boss Altar", [2] = "Dio", [3] = workspace:WaitForChild("NPCSpawns"):WaitForChild("Boss Altar"):WaitForChild("Spawn"):WaitForChild("Part") }
        pcall(function()
            game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("NpcFunc"):InvokeServer(unpack(spawnArgs))
        end)

        task.wait(1.5)
    end
end
